{"componentChunkName":"component---src-components-blog-tsx","path":"/schema/","result":{"data":{"markdownRemark":{"htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Graphql has its own type system, and converting it to typescript will make life easier. There are many tools to do that, including "},{"type":"element","tagName":"a","properties":{"href":"https://the-guild.dev/graphql/codegen"},"children":[{"type":"text","value":"graphql-codegen"}]},{"type":"text","value":" or "},{"type":"element","tagName":"a","properties":{"href":"https://www.apollographql.com/blog/tooling/apollo-codegen/typescript-graphql-code-generator-generate-graphql-types/"},"children":[{"type":"text","value":"apollo codegen:generate"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"However, in this article, I will focus less on the \"tool\" side, but focus on a global vision on how graphql schema and types work in the backend side and frontend side."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Before generating types in the backend: Load separated schema to a grouped schema"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"What is a graphql schema ? It's a "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":".graphql"}]},{"type":"text","value":" file containing graphql type definition."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"It's a common practice to not write all of your schemas into one file, but to split them into functional scope based folders and to use the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"#import"}]},{"type":"text","value":" syntax. In this case, we need to group the separated schemas into a grouped schema. Once we have the grouped schema, then we could use it to build the graphql server (by passing to typeDefs param), or creating typescript types from it."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://the-guild.dev/graphql/tools/docs/schema-loading"},"children":[{"type":"text","value":"There is a really nice article"}]},{"type":"text","value":" about how to load graphql schemas from different sources. In general, we will need "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"loadSchemaSync"}]},{"type":"text","value":" function from "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"graphql-tools/load"}]},{"type":"text","value":" library and "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@graphql-tools/graphql-file-loader"}]},{"type":"text","value":" library."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Generate typescript types from the grouped schema in the Backend"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Once we have the grouped schema, then we could generate types from it. There are multiple libraries to do that, most commonly, "},{"type":"element","tagName":"a","properties":{"href":"https://the-guild.dev/graphql/codegen"},"children":[{"type":"text","value":"graphql-codegen"}]},{"type":"text","value":". The generated types are mostly used in resolvers and data model layers."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Pass the schema from Backend to frontend: How Frontend gets the schema to generate typescript types"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Once the backend is released, then the graphql schema is ready to be fetched for the frontend to generate types.\nIf we use graphql-codegen, there are several ways to load the schema:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"In the schema field, use the server localhost url "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"http://localhost:3000/graphql"}]},{"type":"text","value":", in this case we need to set up server to get schema."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Get the schema from preprod environment, use the url "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"https://api.preprod.xx/graphql"}]},{"type":"text","value":", the advantage is we don't need to set up the server, but the thing is that the preprod schema could be misleading."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Use a static file path. But in this case we need to download the schema first. For example, the schema could be uploaded into a cloud by the CI for each backend release."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Generate types in the frontend"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In the Frontend, sometimes we don't want to generate all types into only one file. In this case, "},{"type":"element","tagName":"a","properties":{"href":"https://the-guild.dev/graphql/codegen"},"children":[{"type":"text","value":"graphql-codegen"}]},{"type":"text","value":" provides a "},{"type":"element","tagName":"a","properties":{"href":"@graphql-codegen/near-operation-file-preset"},"children":[{"type":"text","value":"plugin"}]},{"type":"text","value":" to improve the situation. The generated types will be created into separate files, besides each usage of query or mutation. It will make type importing much easier."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Conclusion"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I have created a mermaid graph to explain the best practice on it:\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 672px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/site-v2.0/static/2c78aa506529c7c7a3bcaeb3aadd6e71/f4ca3/1.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABfUlEQVR42nWT2XKDMAxF+f8/7KRNApjdOxjSJ1VXjBlK2gcNWIKjq8XFts4ESymSMYb6riNrDa18hj94T8MwkNGaliXSa5tpmQON7OvaluOOMgNW5BcAxnGgqioZPPF594cAYM8+TSkDl0DTNFLfdxL/BXxtC32/kljwhlT9ZDUDn1dCDHb+4WyAX32Fd1oAMGcnapuKhr6Rdz31kgTqcwvOFaWL7wBaMwoAVlcPAc7RkeMYnhmQoWjHX0mOks+WuD9I0rWKB6QkWQw7NLcGJoPkb9+A5xLwhCKU6axmsBEYEkxjz0lqSdQ2tbQoqzwrLa4ZAMRa4B09BETVJX3ePuj+dROw5S2wsglR1J6H9waEGiiMwYpCKEVvoRQJqvIug2tUyf1+SluQFIoBLa6T29dhebNtXY6+pRS4Ck8dwwInhi//e1nskR6PB2m9l7Oxeb4JSimJoRX7Ykdq+ZaUZSnxf4eCa+RkEP64KXP0XLqVGG7KrpITOSd+xM/AHwOYlMlGi5k6AAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"1","title":"","src":"/site-v2.0/static/2c78aa506529c7c7a3bcaeb3aadd6e71/ff9d2/1.png","srcSet":["/site-v2.0/static/2c78aa506529c7c7a3bcaeb3aadd6e71/0372f/1.png 168w","/site-v2.0/static/2c78aa506529c7c7a3bcaeb3aadd6e71/2ec80/1.png 336w","/site-v2.0/static/2c78aa506529c7c7a3bcaeb3aadd6e71/ff9d2/1.png 672w","/site-v2.0/static/2c78aa506529c7c7a3bcaeb3aadd6e71/7b5cb/1.png 1008w","/site-v2.0/static/2c78aa506529c7c7a3bcaeb3aadd6e71/275af/1.png 1344w","/site-v2.0/static/2c78aa506529c7c7a3bcaeb3aadd6e71/f4ca3/1.png 1376w"],"sizes":"(max-width: 672px) 100vw, 672px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Thanks for reading !"}]}],"data":{"quirksMode":false}},"frontmatter":{"title":"Generate types from graphql in server side and client side","date":"16 May, 2023"}}},"pageContext":{"slug":"/schema/"}},"staticQueryHashes":["2080627102","265798717"],"slicesMap":{}}